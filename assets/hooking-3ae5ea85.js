import{t as a}from"./translate-bea358b6.js";import{c as i}from"./job-b087b8e4.js";let $=null;const _=(e=["excavationZone"],r=null)=>{for(let s=0;s<e.length;s++)WA.state[`${e[s]}Discovered`]?(WA.room.hideLayer(`${e[s]}/trace`),WA.room.hideLayer(`${e[s]}/search`),WA.room.showLayer(`${e[s]}/found`),r&&r[s]&&r[s]()):(i("makeExcavation")?(WA.room.showLayer(`${e[s]}/trace`),WA.room.onEnterLayer(`${e[s]}/trace`).subscribe(()=>{WA.state[`${e[s]}Discovered`]||($=WA.ui.displayActionMessage({message:a("utils.executeAction",{action:a("modules.excavation.makeExcavations")}),callback:()=>{WA.state[`${e[s]}Discovered`]=!0}}))}),WA.room.onLeaveLayer(`${e[s]}/trace`).subscribe(()=>{$==null||$.remove()})):(WA.room.hideLayer(`${e[s]}/trace`),WA.room.hideLayer(`${e[s]}/search`),WA.room.hideLayer(`${e[s]}/found`)),WA.state.onVariableChange(`${e[s]}Discovered`).subscribe(()=>{L(e[s],r?r[s]:null)}))},L=(e,r=null)=>{WA.room.hideLayer(`${e}/trace`),WA.room.showLayer(`${e}/search`),setTimeout(()=>{WA.room.showLayer(`${e}/found`),setTimeout(()=>{WA.room.hideLayer(`${e}/search`),r&&r()},1e3)},3e3)},p=e=>{for(let r=0;r<e.length;r++)WA.room.onEnterLayer(e[r].stepIn).subscribe(()=>{console.log("caché"),WA.room.hideLayer(e[r].hide)}),WA.room.onLeaveLayer(e[r].stepIn).subscribe(()=>{console.log("pas caché"),WA.room.showLayer(e[r].hide)})};let A=null;const V=(e=["switchingTiles"],r=[])=>{for(let s=0;s<e.length;s++)l(e[s],r[s]??null)},l=(e,r=null,s=!1,m="")=>{const o=JSON.parse(WA.state[`${e}VictoryCondition`]),u=WA.state[`${e}TilesNumber`];if(WA.state[`${e}IsVictory`])r&&r();else for(let t=0;t<Object.keys(o).length;t++)y(e,t),WA.room.onEnterLayer(`${e}/${t}_layer/zone`).subscribe(()=>{WA.state[`${e}IsVictory`]||(s?setTimeout(()=>{A=WA.ui.displayActionMessage({message:a("utils.executeAction",{action:a(m)}),callback:()=>{d(e,t,u,o)}})},100):d(e,t,u,o))}),s&&WA.room.onLeaveLayer(`${e}/${t}_layer/zone`).subscribe(()=>{A==null||A.remove()}),WA.state.onVariableChange(`${e}_${t}_value`).subscribe(()=>{y(e,t)});WA.state.onVariableChange(`${e}IsVictory`).subscribe(t=>{t&&r&&r()})},c=(e,r)=>{for(let s=0;s<Object.keys(r).length;s++)if(WA.state[`${e}_${s}_value`]!=r[s])return!1;return!0},d=(e,r,s,m)=>{let o=WA.state[`${e}_${r}_value`]?WA.state[`${e}_${r}_value`]:0;WA.state[`${e}_${r}_value`]=(o+1)%s,c(e,m)&&(WA.state[`${e}IsVictory`]=!0)},y=(e,r)=>{WA.room.hideLayer(`${e}/${r}_layer`),WA.room.showLayer(`${e}/${r}_layer/${WA.state[`${e}_${r}_value`]}`);for(let s=1;s<4;s++)WA.room.hideLayer(`${e}/${r}_layer_${s}`),WA.room.showLayer(`${e}/${r}_layer_${s}/${WA.state[`${e}_${r}_value`]}`)};let W=null;const D=(e,r=null)=>{WA.state[`${e}Discovered`]?(WA.room.hideLayer(`${e}/trace`),WA.room.hideLayer(`${e}/search`),WA.room.hideLayer(`${e}/disappear`),WA.room.showLayer(`${e}/found`),r&&r()):(i("makeHooking")?(WA.room.showLayer(`${e}/trace`),WA.room.onEnterLayer(`${e}/trace`).subscribe(()=>{WA.state[`${e}Discovered`]||(W=WA.ui.displayActionMessage({message:a("utils.executeAction",{action:a("modules.hooking.hook")}),callback:()=>{WA.state[`${e}Discovered`]=!0}}))}),WA.room.onLeaveLayer(`${e}/trace`).subscribe(()=>{W==null||W.remove()})):(WA.room.hideLayer(`${e}/trace`),WA.room.hideLayer(`${e}/search`),WA.room.hideLayer(`${e}/found`),WA.room.showLayer(`${e}/disappear`)),WA.state.onVariableChange(`${e}Discovered`).subscribe(()=>{f(e,r)}))},f=(e,r=null)=>{WA.room.hideLayer(`${e}/trace`),WA.room.showLayer(`${e}/search`),setTimeout(()=>{WA.room.showLayer(`${e}/found`),WA.room.hideLayer(`${e}/disappear`),setTimeout(()=>{WA.room.hideLayer(`${e}/search`),r&&r()},1e3)},3e3)};export{p as a,D as b,V as c,_ as i,l as s};
