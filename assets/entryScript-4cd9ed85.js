import{c as l,i as $,s as y}from"./job-1210dbfb.js";import{t as i}from"./translate-91669017.js";import{f as c}from"./lobby-840e0083.js";import{i as f,s as L}from"./readRunes-4d7b6dcc.js";import{i as h,d as A}from"./inventory-e3550835.js";import"./config-63dd91cb.js";let n=null;const p=(e=["excavationZone"],t=null)=>{for(let r=0;r<e.length;r++)WA.state[`${e[r]}Discovered`]?(WA.room.hideLayer(`${e[r]}/trace`),WA.room.hideLayer(`${e[r]}/search`),WA.room.showLayer(`${e[r]}/found`),t&&t[r]&&t[r]()):(l("makeExcavation")?(WA.room.showLayer(`${e[r]}/trace`),WA.room.onEnterLayer(`${e[r]}/trace`).subscribe(()=>{WA.state[`${e[r]}Discovered`]||(n=WA.ui.displayActionMessage({message:i("utils.executeAction",{action:i("modules.excavation.makeExcavations")}),callback:()=>{WA.state[`${e[r]}Discovered`]=!0}}))}),WA.room.onLeaveLayer(`${e[r]}/trace`).subscribe(()=>{n==null||n.remove()})):(WA.room.hideLayer(`${e[r]}/trace`),WA.room.hideLayer(`${e[r]}/search`),WA.room.hideLayer(`${e[r]}/found`)),WA.state.onVariableChange(`${e[r]}Discovered`).subscribe(()=>{b(e[r],t?t[r]:null)}))},b=(e,t=null)=>{WA.room.hideLayer(`${e}/trace`),WA.room.showLayer(`${e}/search`),setTimeout(()=>{WA.room.showLayer(`${e}/found`),setTimeout(()=>{WA.room.hideLayer(`${e}/search`),t&&t()},1e3)},3e3)};let u=null;const I=e=>{const t=WA.state.mapWidth,r=WA.state.mapHeight,a=[];for(let s=1;s<t;s++)for(let o=1;o<r;o++)a.push({x:s,y:o,tile:null,layer:`${e}/block`});WA.room.setTiles(a)},_=(e=["secretPassageZone"],t=null)=>{for(let r=0;r<e.length;r++)WA.state[`${e[r]}Discovered`]?(WA.room.hideLayer(`${e[r]}/trace`),WA.room.showLayer(`${e[r]}/found`),WA.room.hideLayer(`${e[r]}/disappear`)):(l("findSecretPassages")?(WA.room.showLayer(`${e[r]}/trace`),WA.room.onEnterLayer(`${e[r]}/trace`).subscribe(()=>{WA.state[`${e[r]}Discovered`]||(u=WA.ui.displayActionMessage({message:i("utils.executeAction",{action:i("modules.secretPassage.findSecretPassage")}),callback:()=>{WA.state[`${e[r]}Discovered`]=!0}}))}),WA.room.onLeaveLayer(`${e[r]}/trace`).subscribe(()=>{u==null||u.remove()})):(WA.room.hideLayer(`${e[r]}/trace`),WA.room.hideLayer(`${e[r]}/found`),WA.room.hideLayer(`${e[r]}/disappear`)),WA.state.onVariableChange(`${e[r]}Discovered`).subscribe(()=>{v(e[r],t?t[r]:null)}))},v=(e,t=null)=>{WA.room.hideLayer(`${e}/trace`),WA.room.showLayer(`${e}/search`),setTimeout(()=>{WA.room.showLayer(`${e}/found`),WA.room.hideLayer(`${e}/disappear`),I(e),setTimeout(()=>{WA.room.hideLayer(`${e}/search`),t&&t()},1e3)},3e3)},D=e=>{for(let t=0;t<e.length;t++)WA.room.onEnterLayer(e[t].stepIn).subscribe(()=>{WA.room.hideLayer(e[t].hide)}),WA.room.onLeaveLayer(e[t].stepIn).subscribe(()=>{WA.room.showLayer(e[t].hide)})},V=(e=["switchingTiles"],t=[])=>{for(let r=0;r<e.length;r++){const a=JSON.parse(WA.state[`${e[r]}VictoryCondition`]),s=WA.state[`${e[r]}TilesNumber`];for(let o=0;o<Object.keys(a).length;o++)W(e[r],o),WA.room.onEnterLayer(`${e[r]}/${o}_layer/zone`).subscribe(()=>{if(!WA.state[`${e[r]}IsVictory`]){let d=WA.state[`${e[r]}_${o}_value`]?WA.state[`${e[r]}_${o}_value`]:0;WA.state[`${e[r]}_${o}_value`]=(d+1)%s,E(e[r],a)&&(WA.state[`${e[r]}IsVictory`]=!0)}}),WA.state.onVariableChange(`${e[r]}IsVictory`).subscribe(d=>{d&&(t!=null&&t[r])&&t[r]()}),WA.state.onVariableChange(`${e[r]}_${o}_value`).subscribe(()=>{W(e[r],o)})}},E=(e,t)=>{for(let r=0;r<Object.keys(t).length;r++)if(WA.state[`${e}_${r}_value`]!=t[r])return!1;return!0},W=(e,t)=>{WA.room.hideLayer(`${e}/${t}_layer`),WA.room.showLayer(`${e}/${t}_layer/${WA.state[`${e}_${t}_value`]}`)};let m=null;const w=(e,t=null)=>{WA.state[`${e}Discovered`]?(WA.room.hideLayer(`${e}/trace`),WA.room.hideLayer(`${e}/search`),WA.room.hideLayer(`${e}/disappear`),WA.room.showLayer(`${e}/found`),t&&t()):(l("makeHooking")?(WA.room.showLayer(`${e}/trace`),WA.room.onEnterLayer(`${e}/trace`).subscribe(()=>{m=WA.ui.displayActionMessage({message:i("utils.executeAction",{action:i("modules.hooking.hook")}),callback:()=>{WA.state[`${e}Discovered`]=!0}})}),WA.room.onLeaveLayer(`${e}/trace`).subscribe(()=>{m==null||m.remove()})):(WA.room.hideLayer(`${e}/trace`),WA.room.hideLayer(`${e}/search`),WA.room.hideLayer(`${e}/found`),WA.room.showLayer(`${e}/disappear`)),WA.state.onVariableChange(`${e}Discovered`).subscribe(()=>{g(e,t)}))},g=(e,t=null)=>{WA.room.hideLayer(`${e}/trace`),WA.room.showLayer(`${e}/search`),setTimeout(()=>{WA.room.showLayer(`${e}/found`),WA.room.hideLayer(`${e}/disappear`),setTimeout(()=>{WA.room.hideLayer(`${e}/search`),t&&t()},1e3)},3e3)};WA.onInit().then(()=>{console.log("INITIALISATION"),$(),y("spy"),console.log("HERE"),p(["excavation"],[()=>{console.log("test callback after excavation")}]),_(["secretPassage"],[()=>{console.log("test callback after finding secret passage")}]),D([{stepIn:"hiddenZoneFloor",hide:"hiddenZoneTop"}]),console.log("Initiate switching tiles"),V(["switchingTiles"],[()=>console.log("OK !")]),console.log("Initiate runes reading !"),f(),L("runeZone",{content:"Il était une fois, dans une royaume lointain, une magnifique princesse. Il était une fois, dans une royaume lointain, une magnifique princesse. Il était une fois, dans une royaume lointain, une magnifique princesse. Il était une fois, dans une royaume lointain, une magnifique princesse. Il était une fois, dans une royaume lointain, une magnifique princesse. Il était une fois, dans une royaume lointain, une magnifique princesse. ",title:"Cendrillon"}),console.log("Initiate inventory !"),h(),A({id:"test",name:"test",description:"Ma super description de test"}),A({id:"test2",name:"test2",image:"https://cdn.pixabay.com/photo/2015/04/23/22/00/tree-736885__480.jpg",description:"Ma super description de test2"}),console.log("Initiate Hooking"),w("hooking",()=>{console.log("Crochetage effectué !")}),console.log("LOBBY INITIALISATION"),c()}).catch(e=>console.error(e));
