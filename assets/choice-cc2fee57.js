import{r as b,g as i,s as n}from"./job-be9a3c43.js";import{t as a}from"./translate-52a641a9.js";import{o as u}from"./discussion-7af67d0c.js";import"./config-63dd91cb.js";const c=async()=>(await WA.players.configureTracking(),WA.players.list()),y=async()=>{const e=await c();for(let t of e)if(!t.state.job)return!1;return WA.state.allPlayersGotJob=!0,!0};WA.onInit().then(()=>{WA.state.onVariableChange("allPlayersGotJob").subscribe(o=>{o&&WA.nav.goToRoom("./map.tmj")}),b();let e;WA.room.onEnterLayer("talk").subscribe(()=>{e=WA.ui.displayActionMessage({message:a("utils.executeAction",{action:a("modules.choice.talk")}),callback:()=>{u("views.choice.title","views.choice.text")}})}),WA.room.onLeaveLayer("talk").subscribe(()=>{e.remove()});let t;WA.room.onEnterLayer("spy").subscribe(async()=>{const o=await c();let s=!1;for(let r of o)r.state.job==="spy"&&(s=!0);!s&&!i()&&(t=WA.ui.displayActionMessage({message:a("utils.executeAction",{action:a("modules.choice.spyMessage")}),callback:()=>{n("spy"),y()}}))}),WA.room.onLeaveLayer("spy").subscribe(()=>{t.remove()});let l;WA.room.onEnterLayer("archeo").subscribe(async()=>{const o=await c();let s=!1;for(let r of o)r.state.job==="archaeologist"&&(s=!0);!s&&!i()&&(l=WA.ui.displayActionMessage({message:a("utils.executeAction",{action:a("modules.choice.archeoMessage")}),callback:()=>{n("archaeologist"),y()}}))}),WA.room.onLeaveLayer("archeo").subscribe(()=>{l.remove()})}).catch(e=>console.error(e));
