import{t as n}from"./translate-a3054a4c.js";import{r as u}from"./sounds-fa21d6c8.js";const r={archaeologist:{useComputers:!1,speakAncienLanguages:!0,readRunes:!0,makeExcavation:!0,findSecretPassages:!1,makeHooking:!1},spy:{useComputers:!0,speakAncienLanguages:!1,readRunes:!1,makeExcavation:!1,findSecretPassages:!0,makeHooking:!0}},b="jobWalletButton";let o=null;const j=e=>{WA.player.state.saveVariable("job",e,{public:!0,persist:!0,scope:"world"});let t=WA.player.uuid,s=t==null?void 0:t.replaceAll(".","").replaceAll("@","");fetch(`https://weasley-project-default-rtdb.europe-west1.firebasedatabase.app/userRole/${s}.json`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({playerId:t,job:e})}).then(a=>a.json()).then(a=>console.log("response",JSON.stringify(a)))},A=()=>WA.player.state.job,f=()=>{WA.player.state.saveVariable("job",null,{public:!0,persist:!0});let e=WA.player.uuid,t=e==null?void 0:e.replaceAll(".","").replaceAll("@","");fetch(`https://weasley-project-default-rtdb.europe-west1.firebasedatabase.app/userRole/${t}.json`,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({playerId:e,job:null})}).then(s=>s.json()).then(s=>console.log("response",JSON.stringify(s)))},y=async()=>{WA.controls.disablePlayerControls(),o=await WA.ui.website.open({url:`${u}/views/jobWallet/jobWallet.html`,allowApi:!0,allowPolicy:"",position:{vertical:"middle",horizontal:"middle"},size:{height:"50vh",width:"50vw"}}),WA.player.state.askForJobWalletWebsiteClose=!1},h=()=>{WA.player.state.askForJobWalletWebsiteClose=!0},c=()=>{o==null||o.close(),o=null,WA.controls.restorePlayerControls()},i=()=>{WA.ui.actionBar.addButton({id:b,label:n("modules.job.myJobWallet.label"),callback:async()=>{o?c():await y()}})},p=()=>{WA.ui.actionBar.removeButton(b)},g=async()=>{WA.controls.disablePlayerControls();let e=WA.player.uuid,t=e==null?void 0:e.replaceAll(".","").replaceAll("@","");const a=await(await fetch(`https://weasley-project-default-rtdb.europe-west1.firebasedatabase.app/userRole/${t}.json`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}})).json();WA.player.state.job=a==null?void 0:a.job,WA.player.state.job?i():p(),WA.player.state.onVariableChange("job").subscribe(l=>{l?(console.log(n("modules.job.jobChanged",{job:n(`modules.job.jobs.${l}`)})),i()):p()}),WA.player.state.onVariableChange("askForJobWalletWebsiteClose").subscribe(l=>{l&&c()}),WA.controls.restorePlayerControls()},m=e=>WA.player.state.job&&r[WA.player.state.job][e],w=()=>WA.player.state.job&&r[WA.player.state.job]?Object.keys(r[WA.player.state.job]).filter(e=>r[WA.player.state.job][e]):null;export{w as a,h as b,m as c,A as g,g as i,f as r,j as s};
