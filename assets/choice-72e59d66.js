import{r as m,g as l,s as y}from"./job-829dd195.js";import{t as e}from"./translate-27362424.js";import{o as u}from"./discussion-7af67d0c.js";import{i as p,g as A,d as g}from"./inventory-f94594f0.js";import"./config-63dd91cb.js";const i=async()=>(await WA.players.configureTracking(),WA.players.list()),b=async()=>{const o=await i();for(let t of o)if(!t.state.job)return!1;return WA.state.allPlayersGotJob=!0,!0};WA.onInit().then(()=>{p(),WA.state.onVariableChange("allPlayersGotJob").subscribe(s=>{s&&WA.nav.goToRoom("./map.tmj")}),m();let o;WA.room.onEnterLayer("talk").subscribe(()=>{o=WA.ui.displayActionMessage({message:e("utils.executeAction",{action:e("choice.talk")}),callback:()=>{u("views.choice.title","views.choice.text")}})}),WA.room.onLeaveLayer("talk").subscribe(()=>{o.remove()});let t;WA.room.onEnterLayer("spy").subscribe(async()=>{const s=await i();let a=!1;for(let r of s)r.state.job==="spy"&&(a=!0);!a&&!l()&&(t=WA.ui.displayActionMessage({message:e("utils.executeAction",{action:e("choice.spyMessage")}),callback:()=>{y("spy"),b()}}))}),WA.room.onLeaveLayer("spy").subscribe(()=>{t.remove()});let c;WA.room.onEnterLayer("archeo").subscribe(async()=>{const s=await i();let a=!1;for(let r of s)r.state.job==="archaeologist"&&(a=!0);!a&&!l()&&(c=WA.ui.displayActionMessage({message:e("utils.executeAction",{action:e("choice.archeoMessage")}),callback:()=>{y("archaeologist"),b()}}))}),WA.room.onLeaveLayer("archeo").subscribe(()=>{c.remove()});let n;WA.room.onEnterLayer("croissants").subscribe(()=>{n=WA.ui.displayActionMessage({message:e("utils.executeAction",{action:e("choice.takeCroissantMessage")}),callback:()=>{const s=A().length;g({id:`croissant${s}`,name:"Croissant",description:"choice.looksDelicious",image:"croissant.png"})}})}),WA.room.onLeaveLayer("croissants").subscribe(()=>{n.remove()})}).catch(o=>console.error(o));
