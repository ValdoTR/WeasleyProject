import{t as e,w as u,a as m}from"./layers-a3f0dd5c.js";import{t as r}from"./translate-9557bc41.js";import{s as g}from"./switchingTiles-3976975d.js";import{o as c}from"./discussion-8e45d0bc.js";import{i as b,s as y}from"./readRunes-5e4bee32.js";import{i as h,h as t,d as p}from"./notifications-26c51365.js";import{i as A,a as i,h as n,b as l}from"./actionForAllPlayers-0f29533a.js";import"./job-42f3db94.js";WA.onInit().then(()=>{h(),b(),y("runesReading",{content:"treasureEnigma.runes.content"});let o=null;g("rotatingStatues",()=>{e("hammerZoneTop",!1),WA.room.onEnterLayer("hammerZone").subscribe(()=>{t("hammer")||(o=WA.ui.displayActionMessage({message:r("utils.executeAction",{action:r("treasureEnigma.hammer.action")}),callback:()=>{p({id:"hammer",name:"treasureEnigma.hammer.name",image:"hammer.png",description:"treasureEnigma.hammer.description"}),e("hammerZone",!1)}}))}),WA.room.onLeaveLayer("hammerZone").subscribe(()=>{o==null||o.remove(),o=null})},!0,"treasureEnigma.makeTurn");let a=null;A("openTreasureDoor",["breakHourglass1","breakHourglass2"],()=>{e("torchesOnBottom",!0),e("torchesOnTop",!0),e("treasureDoor",!1),WA.room.setTiles([{x:14,y:13,tile:null,layer:"treasureDoorCollisions"},{x:15,y:13,tile:null,layer:"treasureDoorCollisions"},{x:16,y:13,tile:null,layer:"treasureDoorCollisions"}])}),i("breakHourglass1",()=>{e("hourglass1FullBottom",!1),e("hourglass1FullTop",!1),e("hourglass1BrokenTop",!0),e("hourglass1BrokenBottom",!0)}),WA.room.onEnterLayer("breakHourglass1Zone").subscribe(()=>{t("hammer")&&!n("breakHourglass1")&&(a=WA.ui.displayActionMessage({message:r("utils.executeAction",{action:r("treasureEnigma.breakHourglass")}),callback:()=>{l("breakHourglass1")}}))}),WA.room.onLeaveLayer("breakHourglass1Zone").subscribe(()=>{a==null||a.remove(),a=null}),i("breakHourglass2",()=>{e("hourglass2FullBottom",!1),e("hourglass2FullTop",!1),e("hourglass2BrokenTop",!0),e("hourglass2BrokenBottom",!0)}),WA.room.onEnterLayer("breakHourglass2Zone").subscribe(()=>{t("hammer")&&!n("breakHourglass2")&&(a=WA.ui.displayActionMessage({message:r("utils.executeAction",{action:r("treasureEnigma.breakHourglass")}),callback:()=>{l("breakHourglass2")}}))}),WA.room.onLeaveLayer("breakHourglass2Zone").subscribe(()=>{a==null||a.remove(),a=null}),i("evilGuyAppears",async()=>{WA.controls.disablePlayerControls(),WA.camera.set(15*32+16,4*32+16,50,50,!0,!0),await u(1e3),setTimeout(()=>{e("badGuy",!0)},300),await m(["pouf1","pouf2","pouf3"],100),setTimeout(()=>{c("treasureEnigma.badGuy.name","treasureEnigma.badGuy.monologue","views.choice.close","discussion","bottom","middle","30vh","100vw",()=>{WA.nav.goToRoom("./maze.tmj")})},300)});let s=null;WA.room.onEnterLayer("treasure").subscribe(()=>{s=WA.ui.displayActionMessage({message:r("utils.executeAction",{action:r("treasureEnigma.takeTheTreasure")}),callback:()=>{l("evilGuyAppears")}})}),WA.room.onLeaveLayer("treasure").subscribe(()=>{s==null||s.remove(),s=null})});
