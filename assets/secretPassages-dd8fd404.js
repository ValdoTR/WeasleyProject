import{t as m}from"./translate-a3054a4c.js";import{c as d}from"./job-1d140806.js";import{p as W}from"./sounds-0ebf4287.js";let e=null;const h=(r,i=null)=>{const l=WA.state.mapWidth,t=WA.state.mapHeight,a=[];if(i)for(let o=1;o<i.length;o++)a.push({x:i[o].x,y:i[o].y,tile:null,layer:`${r}/block`});else for(let o=1;o<l;o++)for(let u=1;u<t;u++)a.push({x:o,y:u,tile:null,layer:`${r}/block`});WA.room.setTiles(a)},p=(r=["secretPassageZone"],i=null,l=null)=>{for(let t=0;t<r.length;t++)WA.state[`${r[t]}Discovered`]?(WA.room.hideLayer(`${r[t]}/trace`),WA.room.showLayer(`${r[t]}/found`),WA.room.hideLayer(`${r[t]}/disappear`)):(d("findSecretPassages")?(WA.room.showLayer(`${r[t]}/trace`),WA.room.onEnterLayer(`${r[t]}/trace`).subscribe(()=>{WA.state[`${r[t]}Discovered`]||(e=WA.ui.displayActionMessage({message:m("utils.executeAction",{action:m("modules.secretPassage.findSecretPassage")}),callback:()=>{WA.state[`${r[t]}Discovered`]=!0}}))}),WA.room.onLeaveLayer(`${r[t]}/trace`).subscribe(()=>{e==null||e.remove()})):WA.room.hideLayer(`${r[t]}/trace`),WA.state.onVariableChange(`${r[t]}Discovered`).subscribe(()=>{A(r[t],i?i[t]:null,l?l[t]:null)}))},A=(r,i=null,l=null)=>{WA.room.hideLayer(`${r}/trace`),WA.room.showLayer(`${r}/search`),setTimeout(()=>{WA.room.showLayer(`${r}/found`),WA.room.hideLayer(`${r}/disappear`),h(r,l),setTimeout(()=>{WA.room.hideLayer(`${r}/search`),W("successSound"),i&&i()},1e3)},3e3)};export{p as i,h as r};
