import{i as m,r as p,g as i,s as y}from"./job-a41bb670.js";import{t as e}from"./translate-b149c22e.js";import{o as u}from"./discussion-c2c87534.js";import{i as g,g as A,d as f}from"./inventory-6e0ec89e.js";import"./sounds-ea3a6419.js";import{h}from"./workadventureFeatures-48ab46db.js";import"./notifications-37bdc9db.js";const n=async()=>(await WA.players.configureTracking(),WA.players.list()),b=async()=>{const s=await n();let a=0;for(let r of s)if(a++,!r.state.job)return!1;return a>0?(WA.state.allPlayersGotJob=!0,!0):!1};WA.onInit().then(async()=>{g(),await m(),h(),u("utils.voiceOver","choice.scenario"),WA.state.onVariableChange("allPlayersGotJob").subscribe(o=>{o&&WA.nav.goToRoom("./museum.tmj")}),p();let s;WA.room.onEnterLayer("talk").subscribe(()=>{s=WA.ui.displayActionMessage({message:e("utils.executeAction",{action:e("choice.talk")}),callback:()=>{u("views.choice.title","views.choice.text")}})}),WA.room.onLeaveLayer("talk").subscribe(()=>{s.remove()});let a;WA.room.onEnterLayer("spy").subscribe(async()=>{const o=await n();let t=!1;for(let c of o)c.state.job==="spy"&&(t=!0);!t&&!i()&&(a=WA.ui.displayActionMessage({message:e("utils.executeAction",{action:e("choice.spyMessage")}),callback:()=>{y("spy"),console.log(i()),b()}}))}),WA.room.onLeaveLayer("spy").subscribe(()=>{a.remove()});let r;WA.room.onEnterLayer("archeo").subscribe(async()=>{const o=await n();let t=!1;for(let c of o)c.state.job==="archaeologist"&&(t=!0);!t&&!i()&&(r=WA.ui.displayActionMessage({message:e("utils.executeAction",{action:e("choice.archeoMessage")}),callback:()=>{y("archaeologist"),console.log(i()),b()}}))}),WA.room.onLeaveLayer("archeo").subscribe(()=>{r.remove()});let l;WA.room.onEnterLayer("croissants").subscribe(()=>{l=WA.ui.displayActionMessage({message:e("utils.executeAction",{action:e("choice.takeCroissantMessage")}),callback:()=>{const o=A().length;f({id:`croissant${o}`,name:"Croissant",description:"choice.looksDelicious",image:"croissant.png"})}})}),WA.room.onLeaveLayer("croissants").subscribe(()=>{l.remove()})}).catch(s=>console.error(s));
